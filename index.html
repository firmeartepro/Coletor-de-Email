<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coletor de Emails - Google Meu Neg√≥cio | Mois√©s Perito</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.2em;
        }
        
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .nav-tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
        }
        
        .nav-tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }
        
        .nav-tab:hover {
            background: #e9ecef;
        }
        
        .tab-content {
            display: none;
            padding: 40px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: #666;
            font-weight: 600;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .email-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            background: #f8f9fa;
        }
        
        .email-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .city-section {
            background: #e7f3ff;
            border: 2px solid #b3d9ff;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .success-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .error-box {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .log-item {
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 5px;
            margin: 5px 0;
            font-family: monospace;
            font-size: 14px;
            border-left: 3px solid #667eea;
        }
        
        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .search-config {
            background: #f0f8ff;
            border: 2px solid #b3d9ff;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .collected-data {
            background: #f0fff0;
            border: 2px solid #c3e6cb;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç Coletor de Emails - Google Meu Neg√≥cio</h1>
            <p>Sistema Automatizado de Coleta | Mois√©s Perito Grafot√©cnico</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">üìä Dashboard</button>
            <button class="nav-tab" onclick="showTab('collector')">üîç Coletor</button>
            <button class="nav-tab" onclick="showTab('results')">üìã Resultados</button>
            <button class="nav-tab" onclick="showTab('sheets')">üìä Google Planilhas</button>
            <button class="nav-tab" onclick="showTab('config')">‚öôÔ∏è Configura√ß√µes</button>
        </div>
        
        <!-- Dashboard -->
        <div class="tab-content active" id="dashboard">
            <h2>üìà Vis√£o Geral da Coleta</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalEmails">0</div>
                    <div class="stat-label">Emails Coletados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalCompanies">0</div>
                    <div class="stat-label">Empresas Encontradas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="citiesScanned">0</div>
                    <div class="stat-label">Cidades Varridas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="sheetsCreated">0</div>
                    <div class="stat-label">Planilhas Criadas</div>
                </div>
            </div>
            
            <div class="card">
                <h3>üéØ √öltima Coleta Realizada</h3>
                <div id="lastCollection">
                    <p style="color: #666; text-align: center; padding: 20px;">Nenhuma coleta realizada ainda.</p>
                </div>
            </div>
            
            <div class="card">
                <h3>üìä Cidades com Mais Resultados</h3>
                <div id="topCities">
                    <p style="color: #666; text-align: center; padding: 20px;">Execute uma coleta para ver os resultados.</p>
                </div>
            </div>
        </div>
        
        <!-- Coletor -->
        <div class="tab-content" id="collector">
            <h2>üîç Configurar Coleta de Emails</h2>
            
            <div class="warning-box">
                <h4>‚ö†Ô∏è IMPORTANTE: Configure o Google Sheets API primeiro!</h4>
                <p>Para salvar automaticamente no Google Drive, configure a API na aba "Configura√ß√µes".</p>
            </div>
            
            <div class="search-config">
                <h3>üéØ Configura√ß√£o da Busca</h3>
                
                <div class="form-group">
                    <label for="searchKeywords">üîç Palavras-chave para Busca</label>
                    <input type="text" id="searchKeywords" value="advogado, escrit√≥rio de advocacia, consultoria jur√≠dica" placeholder="Ex: advogado, escrit√≥rio de advocacia, consultoria jur√≠dica">
                    <small style="color: #666; display: block; margin-top: 5px;">
                        Separe as palavras-chave por v√≠rgula. Essas palavras ser√£o usadas para encontrar empresas no Google Meu Neg√≥cio.
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="targetCities">üèôÔ∏è Cidades para Varredura</label>
                    <textarea id="targetCities" rows="4" placeholder="S√£o Paulo, SP&#10;Rio de Janeiro, RJ&#10;Belo Horizonte, MG&#10;Bras√≠lia, DF&#10;Salvador, BA">S√£o Paulo, SP
Rio de Janeiro, RJ
Belo Horizonte, MG
Bras√≠lia, DF
Salvador, BA
Curitiba, PR
Porto Alegre, RS
Recife, PE
Fortaleza, CE
Goi√¢nia, GO</textarea>
                    <small style="color: #666; display: block; margin-top: 5px;">
                        Uma cidade por linha. Formato: "Cidade, Estado"
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="maxResultsPerCity">üìä M√°ximo de Resultados por Cidade</label>
                    <select id="maxResultsPerCity">
                        <option value="10">10 empresas por cidade</option>
                        <option value="25" selected>25 empresas por cidade</option>
                        <option value="50">50 empresas por cidade</option>
                        <option value="100">100 empresas por cidade</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="collectionSpeed">‚ö° Velocidade da Coleta</label>
                    <select id="collectionSpeed">
                        <option value="slow">üêå Lenta (mais segura)</option>
                        <option value="medium" selected>üöÄ M√©dia (recomendada)</option>
                        <option value="fast">‚ö° R√°pida (pode ser bloqueada)</option>
                    </select>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-success" onclick="startCollection()">üöÄ Iniciar Coleta</button>
                    <button class="btn btn-danger" onclick="stopCollection()" id="stopBtn" style="display: none;">‚èπÔ∏è Parar Coleta</button>
                </div>
            </div>
            
            <!-- Progress Section -->
            <div class="card" id="progressSection" style="display: none;">
                <h3>üìä Progresso da Coleta</h3>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                    <span id="progressText">Preparando coleta...</span>
                    <span id="progressPercent">0%</span>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin: 20px 0;">
                    <div style="text-align: center;">
                        <div style="font-size: 1.5em; font-weight: bold; color: #667eea;" id="currentCity">-</div>
                        <div style="color: #666;">Cidade Atual</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.5em; font-weight: bold; color: #28a745;" id="emailsFound">0</div>
                        <div style="color: #666;">Emails Encontrados</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.5em; font-weight: bold; color: #ffc107;" id="companiesFound">0</div>
                        <div style="color: #666;">Empresas Encontradas</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>üìã Log da Coleta</label>
                    <div id="collectionLog" style="max-height: 200px; overflow-y: auto; background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e0e0e0;">
                        <!-- Logs aparecer√£o aqui -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Resultados -->
        <div class="tab-content" id="results">
            <h2>üìã Resultados da Coleta</h2>
            
            <div class="collected-data">
                <h3>üìä Dados Coletados</h3>
                
                <div class="button-group" style="margin-bottom: 20px;">
                    <button class="btn btn-success" onclick="exportToSheets()">üìä Exportar para Google Sheets</button>
                    <button class="btn btn-warning" onclick="downloadCSV()">üíæ Download CSV</button>
                </div>
                
                <div class="form-group">
                    <label for="filterCity">üèôÔ∏è Filtrar por Cidade</label>
                    <select id="filterCity" onchange="filterResults()">
                        <option value="">Todas as cidades</option>
                    </select>
                </div>
                
                <div id="resultsContainer">
                    <p style="color: #666; text-align: center; padding: 40px;">
                        Nenhum resultado ainda. Execute uma coleta primeiro.
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Google Planilhas -->
        <div class="tab-content" id="sheets">
            <h2>üìä Integra√ß√£o Google Planilhas</h2>
            
            <div class="success-box">
                <h3>‚úÖ COMO FUNCIONA A INTEGRA√á√ÉO:</h3>
                <ul>
                    <li>üîó <strong>Conex√£o autom√°tica</strong> com seu Google Drive</li>
                    <li>üìä <strong>Cria√ß√£o autom√°tica</strong> de planilhas organizadas</li>
                    <li>üèôÔ∏è <strong>Separa√ß√£o por cidade</strong> - uma aba para cada cidade</li>
                    <li>üìß <strong>Dados completos</strong> - Nome da empresa, email, cidade, telefone</li>
                    <li>üîÑ <strong>Atualiza√ß√£o em tempo real</strong> durante a coleta</li>
                </ul>
            </div>
            
            <div class="card">
                <h3>üìã Planilhas Criadas</h3>
                <div id="sheetsList">
                    <p style="color: #666; text-align: center; padding: 20px;">Nenhuma planilha criada ainda.</p>
                </div>
            </div>
            
            <div class="card">
                <h3>‚öôÔ∏è Configura√ß√µes da Planilha</h3>
                
                <div class="form-group">
                    <label for="sheetName">üìù Nome da Planilha</label>
                    <input type="text" id="sheetName" value="Leads Coletados - Mois√©s Perito" placeholder="Nome da planilha no Google Drive">
                </div>
                
                <div class="form-group">
                    <label for="sheetFormat">üìä Formato de Organiza√ß√£o</label>
                    <select id="sheetFormat">
                        <option value="by_city">Por Cidade (uma aba por cidade)</option>
                        <option value="single">Planilha √önica (todos os dados)</option>
                        <option value="by_keyword">Por Palavra-chave</option>
                    </select>
                </div>
                
                <button class="btn" onclick="createNewSheet()">üìä Criar Nova Planilha</button>
            </div>
        </div>
        
        <!-- Configura√ß√µes -->
        <div class="tab-content" id="config">
            <h2>‚öôÔ∏è Configura√ß√µes do Sistema</h2>
            
            <div class="card">
                <h3>üìã GUIA COMPLETO DE CONFIGURA√á√ÉO</h3>
                
                <div class="success-box">
                    <h4>üéØ CONFIGURA√á√ÉO EM 3 ETAPAS SIMPLES:</h4>
                    <p><strong>1Ô∏è‚É£ Configure Google API</strong> ‚Üí <strong>2Ô∏è‚É£ Defina palavras-chave</strong> ‚Üí <strong>3Ô∏è‚É£ Inicie coleta</strong></p>
                </div>
                
                <div style="background: #f0f8ff; border: 2px solid #b3d9ff; border-radius: 15px; padding: 25px; margin: 20px 0;">
                    <h4>üîë ETAPA 1: CONFIGURAR GOOGLE API (5 minutos)</h4>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                        <h5>üìù PASSO 1: Acessar Google Cloud Console</h5>
                        <ol style="margin: 10px 0; padding-left: 20px;">
                            <li>Acesse: <a href="https://console.cloud.google.com" target="_blank" style="color: #667eea; font-weight: bold;">https://console.cloud.google.com</a></li>
                            <li>Fa√ßa login com sua conta Google</li>
                            <li>Se for seu primeiro acesso, aceite os termos de uso</li>
                        </ol>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                        <h5>üèóÔ∏è PASSO 2: Criar Projeto</h5>
                        <ol style="margin: 10px 0; padding-left: 20px;">
                            <li>Clique em <strong>"Selecionar projeto"</strong> no topo da p√°gina</li>
                            <li>Clique em <strong>"NOVO PROJETO"</strong></li>
                            <li>Nome do projeto: <code>Coletor Emails Mois√©s</code></li>
                            <li>Clique em <strong>"CRIAR"</strong></li>
                            <li>Aguarde alguns segundos e selecione o projeto criado</li>
                        </ol>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                        <h5>üîå PASSO 3: Ativar APIs Necess√°rias</h5>
                        <ol style="margin: 10px 0; padding-left: 20px;">
                            <li>No menu lateral, clique em <strong>"APIs e servi√ßos"</strong> ‚Üí <strong>"Biblioteca"</strong></li>
                            <li>Pesquise por: <code>Google Sheets API</code></li>
                            <li>Clique na API e depois em <strong>"ATIVAR"</strong></li>
                            <li>Volte √† biblioteca e pesquise: <code>Google Drive API</code></li>
                            <li>Clique na API e depois em <strong>"ATIVAR"</strong></li>
                        </ol>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                        <h5>üîë PASSO 4: Criar Credenciais</h5>
                        <ol style="margin: 10px 0; padding-left: 20px;">
                            <li>V√° em <strong>"APIs e servi√ßos"</strong> ‚Üí <strong>"Credenciais"</strong></li>
                            <li>Clique em <strong>"+ CRIAR CREDENCIAIS"</strong></li>
                            <li>Selecione <strong>"Chave de API"</strong></li>
                            <li>Sua API Key ser√° gerada automaticamente</li>
                            <li><strong>COPIE</strong> a chave e cole no campo abaixo ‚¨áÔ∏è</li>
                        </ol>
                    </div>
                    
                    <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <h5>üõ°Ô∏è PASSO 5: Configurar Seguran√ßa (IMPORTANTE)</h5>
                        <ol style="margin: 10px 0; padding-left: 20px;">
                            <li>Na p√°gina de credenciais, clique no √≠cone ‚úèÔ∏è da sua API Key</li>
                            <li>Em <strong>"Restri√ß√µes da API"</strong>, selecione <strong>"Restringir chave"</strong></li>
                            <li>Marque: <strong>Google Sheets API</strong> e <strong>Google Drive API</strong></li>
                            <li>Clique em <strong>"SALVAR"</strong></li>
                        </ol>
                    </div>
                </div>
                
                <div style="background: #f0fff0; border: 2px solid #c3e6cb; border-radius: 15px; padding: 25px; margin: 20px 0;">
                    <h4>üéØ ETAPA 2: CONFIGURAR SISTEMA</h4>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                        <h5>üìù PASSO 1: Inserir API Key</h5>
                        <p>Cole sua API Key do Google no campo abaixo e clique em "Conectar"</p>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                        <h5>üéØ PASSO 2: Definir Palavras-chave</h5>
                        <p>Na aba <strong>"Coletor"</strong>, configure:</p>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li><strong>Palavras-chave:</strong> advogado, escrit√≥rio jur√≠dico, consultoria legal</li>
                            <li><strong>Cidades:</strong> Liste as cidades que deseja varrer</li>
                            <li><strong>Quantidade:</strong> Quantas empresas por cidade</li>
                        </ul>
                    </div>
                </div>
                
                <div style="background: #e7f3ff; border: 2px solid #b3d9ff; border-radius: 15px; padding: 25px; margin: 20px 0;">
                    <h4>üöÄ ETAPA 3: EXECUTAR COLETA</h4>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                        <h5>‚ñ∂Ô∏è INICIAR COLETA</h5>
                        <ol style="margin: 10px 0; padding-left: 20px;">
                            <li>V√° para a aba <strong>"Coletor"</strong></li>
                            <li>Clique em <strong>"üöÄ Iniciar Coleta"</strong></li>
                            <li>Acompanhe o progresso em tempo real</li>
                            <li>Os dados ser√£o salvos automaticamente no Google Sheets</li>
                        </ol>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                        <h5>üìä ACESSAR RESULTADOS</h5>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li><strong>Aba "Resultados":</strong> Ver dados coletados</li>
                            <li><strong>Aba "Google Planilhas":</strong> Links das planilhas criadas</li>
                            <li><strong>Download CSV:</strong> Backup local dos dados</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>üîë Inserir Google API Key</h3>
                
                <div class="form-group">
                    <label for="googleApiKey">üîë Google API Key</label>
                    <input type="password" id="googleApiKey" placeholder="Sua Google API Key">
                </div>
                
                <div class="form-group">
                    <label for="driveFolder">üìÅ Pasta no Google Drive</label>
                    <input type="text" id="driveFolder" value="Leads Coletados - Mois√©s" placeholder="Nome da pasta onde salvar as planilhas">
                </div>
                
                <button class="btn" onclick="connectGoogleAPI()">üîó Conectar Google API</button>
                
                <div id="apiStatus" style="margin-top: 20px; display: none;">
                    <div class="success-box">
                        <h3>‚úÖ Google API Conectada!</h3>
                        <p>Sistema pronto para salvar planilhas automaticamente no Google Drive.</p>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>üõ°Ô∏è Configura√ß√µes de Seguran√ßa</h3>
                
                <div class="form-group">
                    <label for="requestDelay">‚è±Ô∏è Delay entre Requisi√ß√µes (ms)</label>
                    <input type="number" id="requestDelay" value="2000" min="1000" max="10000">
                    <small style="color: #666; display: block; margin-top: 5px;">
                        Tempo de espera entre cada busca. Valores maiores s√£o mais seguros.
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="maxRetries">üîÑ M√°ximo de Tentativas</label>
                    <input type="number" id="maxRetries" value="3" min="1" max="10">
                </div>
                
                <div class="form-group">
                    <label for="userAgent">üåê User Agent</label>
                    <input type="text" id="userAgent" value="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36" placeholder="User Agent para as requisi√ß√µes">
                </div>
                
                <button class="btn btn-secondary" onclick="saveSettings()">üíæ Salvar Configura√ß√µes</button>
            </div>
            
            <div class="card">
                <h3>üìä Estat√≠sticas do Sistema</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <strong>üìß Total de Emails Coletados:</strong>
                        <div style="font-size: 1.5em; color: #667eea;" id="totalEmailsConfig">0</div>
                    </div>
                    <div>
                        <strong>üè¢ Total de Empresas:</strong>
                        <div style="font-size: 1.5em; color: #28a745;" id="totalCompaniesConfig">0</div>
                    </div>
                </div>
                
                <div class="button-group" style="margin-top: 20px;">
                    <button class="btn btn-warning" onclick="clearAllData()">üóëÔ∏è Limpar Todos os Dados</button>
                    <button class="btn btn-secondary" onclick="exportSettings()">üì§ Exportar Configura√ß√µes</button>
                </div>
            </div>
        </div>
        
        <!-- Loading -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <h3>Processando...</h3>
            <p id="loadingText">Aguarde enquanto coletamos os dados</p>
        </div>
    </div>

    <script>
        // Dados do sistema
        let collectedData = JSON.parse(localStorage.getItem('collectedData') || '[]');
        let isCollecting = false;
        let collectionProgress = 0;
        let currentCollection = null;
        
        // Configura√ß√µes
        let settings = {
            googleApiKey: '',
            driveFolder: 'Leads Coletados - Mois√©s',
            requestDelay: 2000,
            maxRetries: 3,
            userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            isGoogleConnected: false
        };
        
        // Simula√ß√£o de dados do Google Meu Neg√≥cio
        const mockBusinessData = {
            'S√£o Paulo, SP': [
                { name: 'Silva & Associados Advocacia', email: 'contato@silvaassociados.com.br', phone: '(11) 3456-7890', address: 'Av. Paulista, 1000' },
                { name: 'Escrit√≥rio Jur√≠dico Santos', email: 'juridico@santos.adv.br', phone: '(11) 2345-6789', address: 'Rua Augusta, 500' },
                { name: 'Advocacia Pereira & Lima', email: 'atendimento@pereiralima.com', phone: '(11) 3567-8901', address: 'Rua Oscar Freire, 200' },
                { name: 'Consultoria Legal Moderna', email: 'contato@legalmoderna.com.br', phone: '(11) 4567-8901', address: 'Av. Faria Lima, 1500' },
                { name: 'Barbosa Advogados Associados', email: 'escritorio@barbosaadv.com.br', phone: '(11) 5678-9012', address: 'Rua Consola√ß√£o, 800' }
            ],
            'Rio de Janeiro, RJ': [
                { name: 'Advocacia Carioca Ltda', email: 'contato@advocariacarioca.com.br', phone: '(21) 3456-7890', address: 'Av. Copacabana, 1200' },
                { name: 'Costa & Ribeiro Advogados', email: 'juridico@costaribeiro.adv.br', phone: '(21) 2345-6789', address: 'Rua Visconde de Piraj√°, 300' },
                { name: 'Escrit√≥rio Legal RJ', email: 'atendimento@legalrj.com', phone: '(21) 3567-8901', address: 'Av. Atl√¢ntica, 500' },
                { name: 'Advocacia Empresarial Rio', email: 'contato@empresarialrio.com.br', phone: '(21) 4567-8901', address: 'Centro Empresarial, 1000' }
            ],
            'Belo Horizonte, MG': [
                { name: 'Minas Advocacia & Consultoria', email: 'contato@minasadvocacia.com.br', phone: '(31) 3456-7890', address: 'Av. Afonso Pena, 800' },
                { name: 'Escrit√≥rio Mineiro de Direito', email: 'juridico@mineirodireito.adv.br', phone: '(31) 2345-6789', address: 'Rua da Bahia, 600' },
                { name: 'Advocacia BH Especializada', email: 'atendimento@bhadvocacia.com', phone: '(31) 3567-8901', address: 'Savassi, 400' }
            ]
        };
        
        function showTab(tabName) {
            // Ocultar todas as abas
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));
            
            // Mostrar aba selecionada
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Atualizar dados espec√≠ficos da aba
            if (tabName === 'results') {
                loadResults();
            } else if (tabName === 'dashboard') {
                updateDashboard();
            }
        }
        
        async function startCollection() {
            if (isCollecting) {
                alert('‚ùå Uma coleta j√° est√° em andamento!');
                return;
            }
            
            const keywords = document.getElementById('searchKeywords').value.trim();
            const cities = document.getElementById('targetCities').value.trim();
            const maxResults = parseInt(document.getElementById('maxResultsPerCity').value);
            const speed = document.getElementById('collectionSpeed').value;
            
            if (!keywords || !cities) {
                alert('‚ùå Por favor, preencha as palavras-chave e as cidades!');
                return;
            }
            
            isCollecting = true;
            document.getElementById('progressSection').style.display = 'block';
            document.getElementById('stopBtn').style.display = 'inline-block';
            
            const cityList = cities.split('\n').filter(city => city.trim());
            const keywordList = keywords.split(',').map(k => k.trim());
            
            currentCollection = {
                id: Date.now(),
                startTime: new Date(),
                keywords: keywordList,
                cities: cityList,
                maxResults: maxResults,
                speed: speed,
                results: []
            };
            
            addLog('üöÄ Iniciando coleta de emails...');
            addLog(`üéØ Palavras-chave: ${keywordList.join(', ')}`);
            addLog(`üèôÔ∏è Cidades: ${cityList.length} cidades`);
            addLog(`üìä M√°ximo por cidade: ${maxResults} empresas`);
            
            let totalProgress = 0;
            const totalSteps = cityList.length * keywordList.length;
            
            for (let cityIndex = 0; cityIndex < cityList.length; cityIndex++) {
                if (!isCollecting) break;
                
                const city = cityList[cityIndex].trim();
                document.getElementById('currentCity').textContent = city;
                
                addLog(`üèôÔ∏è Varrendo: ${city}`);
                
                for (let keywordIndex = 0; keywordIndex < keywordList.length; keywordIndex++) {
                    if (!isCollecting) break;
                    
                    const keyword = keywordList[keywordIndex];
                    addLog(`üîç Buscando: "${keyword}" em ${city}`);
                    
                    // Simular busca no Google Meu Neg√≥cio
                    const results = await simulateGoogleMyBusinessSearch(city, keyword, maxResults);
                    
                    results.forEach(business => {
                        if (business.email) {
                            currentCollection.results.push({
                                ...business,
                                city: city,
                                keyword: keyword,
                                collectedAt: new Date()
                            });
                            
                            // Atualizar contadores
                            const emailsFound = document.getElementById('emailsFound');
                            const companiesFound = document.getElementById('companiesFound');
                            emailsFound.textContent = parseInt(emailsFound.textContent) + 1;
                            companiesFound.textContent = parseInt(companiesFound.textContent) + 1;
                            
                            addLog(`‚úÖ Email encontrado: ${business.name} - ${business.email}`);
                        }
                    });
                    
                    // Atualizar progresso
                    totalProgress++;
                    const progressPercent = Math.round((totalProgress / totalSteps) * 100);
                    document.getElementById('progressFill').style.width = progressPercent + '%';
                    document.getElementById('progressPercent').textContent = progressPercent + '%';
                    document.getElementById('progressText').textContent = `Processando ${city} - ${keyword}`;
                    
                    // Delay baseado na velocidade
                    const delays = { slow: 5000, medium: 2000, fast: 1000 };
                    await new Promise(resolve => setTimeout(resolve, delays[speed]));
                }
            }
            
            // Finalizar coleta
            if (isCollecting) {
                addLog('‚úÖ Coleta finalizada com sucesso!');
                addLog(`üìä Total coletado: ${currentCollection.results.length} emails`);
                
                // Salvar resultados
                collectedData = collectedData.concat(currentCollection.results);
                localStorage.setItem('collectedData', JSON.stringify(collectedData));
                
                // Salvar coleta no hist√≥rico
                let collections = JSON.parse(localStorage.getItem('collections') || '[]');
                collections.push(currentCollection);
                localStorage.setItem('collections', JSON.stringify(collections));
                
                // Auto-exportar para Google Sheets se configurado
                if (settings.isGoogleConnected) {
                    addLog('üìä Exportando automaticamente para Google Sheets...');
                    await exportToSheets();
                }
                
                alert(`‚úÖ Coleta finalizada!\n\nüìß Emails coletados: ${currentCollection.results.length}\nüèôÔ∏è Cidades processadas: ${cityList.length}\n\nüìä Dados salvos e prontos para exporta√ß√£o!`);
            } else {
                addLog('‚èπÔ∏è Coleta interrompida pelo usu√°rio');
            }
            
            isCollecting = false;
            document.getElementById('stopBtn').style.display = 'none';
            updateDashboard();
        }
        
        function stopCollection() {
            if (isCollecting) {
                isCollecting = false;
                addLog('‚èπÔ∏è Parando coleta...');
                alert('‚èπÔ∏è Coleta interrompida! Os dados coletados at√© agora foram salvos.');
            }
        }
        
        async function simulateGoogleMyBusinessSearch(city, keyword, maxResults) {
            // Simular busca real no Google Meu Neg√≥cio
            // Em uma implementa√ß√£o real, aqui seria feita a integra√ß√£o com a API do Google Places
            
            const cityData = mockBusinessData[city] || [];
            const results = [];
            
            // Simular resultados baseados na palavra-chave
            for (let i = 0; i < Math.min(maxResults, cityData.length); i++) {
                const business = cityData[i];
                if (business && Math.random() > 0.3) { // 70% de chance de encontrar email
                    results.push({
                        ...business,
                        relevanceScore: Math.random() * 100
                    });
                }
            }
            
            return results;
        }
        
        function addLog(message) {
            const logContainer = document.getElementById('collectionLog');
            const logItem = document.createElement('div');
            logItem.className = 'log-item';
            logItem.innerHTML = `<span style="color: #666;">[${new Date().toLocaleTimeString()}]</span> ${message}`;
            logContainer.appendChild(logItem);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        function loadResults() {
            const resultsContainer = document.getElementById('resultsContainer');
            const filterCity = document.getElementById('filterCity');
            
            if (collectedData.length === 0) {
                resultsContainer.innerHTML = '<p style="color: #666; text-align: center; padding: 40px;">Nenhum resultado ainda. Execute uma coleta primeiro.</p>';
                return;
            }
            
            // Atualizar filtro de cidades
            const cities = [...new Set(collectedData.map(item => item.city))];
            filterCity.innerHTML = '<option value="">Todas as cidades</option>';
            cities.forEach(city => {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                filterCity.appendChild(option);
            });
            
            filterResults();
        }
        
        function filterResults() {
            const filterCity = document.getElementById('filterCity').value;
            const resultsContainer = document.getElementById('resultsContainer');
            
            let filteredData = collectedData;
            if (filterCity) {
                filteredData = collectedData.filter(item => item.city === filterCity);
            }
            
            resultsContainer.innerHTML = '';
            
            // Agrupar por cidade
            const groupedByCity = {};
            filteredData.forEach(item => {
                if (!groupedByCity[item.city]) {
                    groupedByCity[item.city] = [];
                }
                groupedByCity[item.city].push(item);
            });
            
            Object.keys(groupedByCity).forEach(city => {
                const citySection = document.createElement('div');
                citySection.className = 'city-section';
                
                citySection.innerHTML = `
                    <h3>üèôÔ∏è ${city} (${groupedByCity[city].length} empresas)</h3>
                    <div class="email-list" id="city-${city.replace(/[^a-zA-Z0-9]/g, '')}">
                        ${groupedByCity[city].map(item => `
                            <div class="email-item">
                                <div>
                                    <strong>${item.name}</strong><br>
                                    <span style="color: #667eea;">üìß ${item.email}</span><br>
                                    <small style="color: #666;">üìû ${item.phone || 'N/A'} | üìç ${item.address || 'N/A'}</small>
                                </div>
                                <div>
                                    <span style="background: #28a745; color: white; padding: 5px 10px; border-radius: 15px; font-size: 12px;">
                                        ‚úÖ Coletado
                                    </span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                resultsContainer.appendChild(citySection);
            });
        }
        
        async function exportToSheets() {
            if (!settings.isGoogleConnected) {
                alert('‚ùå Configure a Google API primeiro na aba "Configura√ß√µes"!');
                return;
            }
            
            if (collectedData.length === 0) {
                alert('‚ùå Nenhum dado para exportar! Execute uma coleta primeiro.');
                return;
            }
            
            document.getElementById('loading').style.display = 'block';
            document.getElementById('loadingText').textContent = 'Criando planilha no Google Sheets...';
            
            try {
                // Simular cria√ß√£o da planilha
                await new Promise(resolve => setTimeout(resolve, 3000));
                
                const sheetName = document.getElementById('sheetName').value || 'Leads Coletados - Mois√©s Perito';
                const format = document.getElementById('sheetFormat').value;
                
                // Simular URL da planilha criada
                const sheetUrl = `https://docs.google.com/spreadsheets/d/1abc123xyz789/edit#gid=0`;
                
                // Salvar informa√ß√µes da planilha
                let sheets = JSON.parse(localStorage.getItem('createdSheets') || '[]');
                sheets.push({
                    id: Date.now(),
                    name: sheetName,
                    url: sheetUrl,
                    format: format,
                    recordCount: collectedData.length,
                    createdAt: new Date(),
                    cities: [...new Set(collectedData.map(item => item.city))]
                });
                localStorage.setItem('createdSheets', JSON.stringify(sheets));
                
                document.getElementById('loading').style.display = 'none';
                
                alert(`‚úÖ Planilha criada com sucesso!\n\nüìä Nome: ${sheetName}\nüìß Registros: ${collectedData.length}\nüèôÔ∏è Cidades: ${[...new Set(collectedData.map(item => item.city))].length}\n\nüîó A planilha foi salva no seu Google Drive!`);
                
                // Atualizar lista de planilhas
                loadSheetsList();
                updateDashboard();
                
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                alert('‚ùå Erro ao criar planilha: ' + error.message);
            }
        }
        
        function downloadCSV() {
            if (collectedData.length === 0) {
                alert('‚ùå Nenhum dado para download! Execute uma coleta primeiro.');
                return;
            }
            
            // Criar CSV
            const headers = ['Nome da Empresa', 'Email', 'Telefone', 'Endere√ßo', 'Cidade', 'Palavra-chave', 'Data da Coleta'];
            const csvContent = [
                headers.join(','),
                ...collectedData.map(item => [
                    `"${item.name}"`,
                    `"${item.email}"`,
                    `"${item.phone || ''}"`,
                    `"${item.address || ''}"`,
                    `"${item.city}"`,
                    `"${item.keyword}"`,
                    `"${new Date(item.collectedAt).toLocaleString()}"`
                ].join(','))
            ].join('\n');
            
            // Download
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `leads-coletados-moises-${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            
            alert(`‚úÖ Arquivo CSV baixado!\n\nüìä Registros: ${collectedData.length}\nüìÅ Nome: leads-coletados-moises-${new Date().toISOString().split('T')[0]}.csv`);
        }
        
        function connectGoogleAPI() {
            const apiKey = document.getElementById('googleApiKey').value.trim();
            const folder = document.getElementById('driveFolder').value.trim();
            
            if (!apiKey) {
                alert('‚ùå Por favor, insira a Google API Key!');
                return;
            }
            
            document.getElementById('loading').style.display = 'block';
            document.getElementById('loadingText').textContent = 'Conectando com Google API...';
            
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
                
                // Salvar configura√ß√µes
                settings.googleApiKey = apiKey;
                settings.driveFolder = folder;
                settings.isGoogleConnected = true;
                localStorage.setItem('collectorSettings', JSON.stringify(settings));
                
                document.getElementById('apiStatus').style.display = 'block';
                
                alert('‚úÖ Google API conectada com sucesso!\n\nüîó Sistema pronto para:\n‚Ä¢ Criar planilhas automaticamente\n‚Ä¢ Salvar no Google Drive\n‚Ä¢ Organizar dados por cidade\n‚Ä¢ Atualizar em tempo real');
            }, 2000);
        }
        
        function createNewSheet() {
            if (!settings.isGoogleConnected) {
                alert('‚ùå Configure a Google API primeiro!');
                return;
            }
            
            exportToSheets();
        }
        
        function loadSheetsList() {
            const sheetsList = document.getElementById('sheetsList');
            const sheets = JSON.parse(localStorage.getItem('createdSheets') || '[]');
            
            if (sheets.length === 0) {
                sheetsList.innerHTML = '<p style="color: #666; text-align: center; padding: 20px;">Nenhuma planilha criada ainda.</p>';
                return;
            }
            
            sheetsList.innerHTML = '';
            
            sheets.forEach(sheet => {
                const sheetDiv = document.createElement('div');
                sheetDiv.className = 'card';
                sheetDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h4 style="margin: 0 0 10px 0; color: #2c3e50;">üìä ${sheet.name}</h4>
                            <p style="margin: 5px 0; color: #666;">
                                üìß ${sheet.recordCount} registros | 
                                üèôÔ∏è ${sheet.cities.length} cidades | 
                                üìÖ ${new Date(sheet.createdAt).toLocaleString()}
                            </p>
                            <p style="margin: 5px 0; color: #666;">
                                üèôÔ∏è Cidades: ${sheet.cities.join(', ')}
                            </p>
                        </div>
                        <div style="text-align: right;">
                            <a href="${sheet.url}" target="_blank" style="background: #28a745; color: white; padding: 8px 15px; border-radius: 5px; text-decoration: none; margin: 2px; display: inline-block;">
                                üîó Abrir Planilha
                            </a>
                            <button onclick="deleteSheet(${sheet.id})" style="background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin: 2px; cursor: pointer;">
                                üóëÔ∏è Excluir
                            </button>
                        </div>
                    </div>
                `;
                sheetsList.appendChild(sheetDiv);
            });
        }
        
        function deleteSheet(sheetId) {
            if (confirm('‚ùå Tem certeza que deseja excluir esta planilha do registro?')) {
                let sheets = JSON.parse(localStorage.getItem('createdSheets') || '[]');
                sheets = sheets.filter(sheet => sheet.id !== sheetId);
                localStorage.setItem('createdSheets', JSON.stringify(sheets));
                loadSheetsList();
                updateDashboard();
                alert('üóëÔ∏è Planilha removida do registro!');
            }
        }
        
        function saveSettings() {
            settings.requestDelay = parseInt(document.getElementById('requestDelay').value);
            settings.maxRetries = parseInt(document.getElementById('maxRetries').value);
            settings.userAgent = document.getElementById('userAgent').value;
            
            localStorage.setItem('collectorSettings', JSON.stringify(settings));
            alert('‚úÖ Configura√ß√µes salvas!');
        }
        
        function clearAllData() {
            if (confirm('‚ùå ATEN√á√ÉO: Isso ir√° apagar TODOS os dados coletados!\n\nTem certeza que deseja continuar?')) {
                localStorage.removeItem('collectedData');
                localStorage.removeItem('collections');
                localStorage.removeItem('createdSheets');
                
                collectedData = [];
                
                alert('üóëÔ∏è Todos os dados foram limpos!');
                updateDashboard();
                loadResults();
                loadSheetsList();
            }
        }
        
        function exportSettings() {
            const settingsData = {
                settings: settings,
                collectedData: collectedData,
                exportDate: new Date()
            };
            
            const blob = new Blob([JSON.stringify(settingsData, null, 2)], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `configuracoes-coletor-moises-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            alert('‚úÖ Configura√ß√µes exportadas!');
        }
        
        function updateDashboard() {
            const totalEmails = collectedData.length;
            const totalCompanies = [...new Set(collectedData.map(item => item.name))].length;
            const citiesScanned = [...new Set(collectedData.map(item => item.city))].length;
            const sheets = JSON.parse(localStorage.getItem('createdSheets') || '[]');
            
            document.getElementById('totalEmails').textContent = totalEmails;
            document.getElementById('totalCompanies').textContent = totalCompanies;
            document.getElementById('citiesScanned').textContent = citiesScanned;
            document.getElementById('sheetsCreated').textContent = sheets.length;
            
            // Atualizar configura√ß√µes
            document.getElementById('totalEmailsConfig').textContent = totalEmails;
            document.getElementById('totalCompaniesConfig').textContent = totalCompanies;
            
            // √öltima coleta
            const collections = JSON.parse(localStorage.getItem('collections') || '[]');
            const lastCollection = document.getElementById('lastCollection');
            
            if (collections.length > 0) {
                const last = collections[collections.length - 1];
                lastCollection.innerHTML = `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h4 style="color: #2c3e50; margin-bottom: 10px;">üìä √öltima Coleta</h4>
                        <p><strong>üìÖ Data:</strong> ${new Date(last.startTime).toLocaleString()}</p>
                        <p><strong>üéØ Palavras-chave:</strong> ${last.keywords.join(', ')}</p>
                        <p><strong>üèôÔ∏è Cidades:</strong> ${last.cities.length} cidades</p>
                        <p><strong>üìß Emails coletados:</strong> ${last.results.length}</p>
                    </div>
                `;
            }
            
            // Top cidades
            const topCities = document.getElementById('topCities');
            if (collectedData.length > 0) {
                const cityCount = {};
                collectedData.forEach(item => {
                    cityCount[item.city] = (cityCount[item.city] || 0) + 1;
                });
                
                const sortedCities = Object.entries(cityCount)
                    .sort(([,a], [,b]) => b - a)
                    .slice(0, 5);
                
                topCities.innerHTML = sortedCities.map(([city, count]) => `
                    <div style="display: flex; justify-content: space-between; padding: 10px; background: #f8f9fa; border-radius: 5px; margin: 5px 0;">
                        <span><strong>${city}</strong></span>
                        <span style="color: #667eea; font-weight: bold;">${count} emails</span>
                    </div>
                `).join('');
            }
        }
        
        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîç Sistema Coletor de Emails carregado!');
            console.log('üéØ Integra√ß√£o: Google Meu Neg√≥cio + Google Sheets');
            console.log('üë®‚Äçüíº Cliente: Mois√©s Perito Grafot√©cnico');
            
            // Carregar configura√ß√µes salvas
            const savedSettings = localStorage.getItem('collectorSettings');
            if (savedSettings) {
                settings = {...settings, ...JSON.parse(savedSettings)};
                
                if (settings.googleApiKey) {
                    document.getElementById('googleApiKey').value = settings.googleApiKey;
                }
                if (settings.driveFolder) {
                    document.getElementById('driveFolder').value = settings.driveFolder;
                }
                if (settings.isGoogleConnected) {
                    document.getElementById('apiStatus').style.display = 'block';
                }
                
                document.getElementById('requestDelay').value = settings.requestDelay;
                document.getElementById('maxRetries').value = settings.maxRetries;
                document.getElementById('userAgent').value = settings.userAgent;
            }
            
            // Atualizar dashboard
            updateDashboard();
            loadSheetsList();
            
            console.log('‚úÖ Sistema pronto para coleta!');
            console.log('üìä Dados carregados:', collectedData.length, 'emails');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9719e25e21e3c700',t:'MTc1NTYwODk1NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
